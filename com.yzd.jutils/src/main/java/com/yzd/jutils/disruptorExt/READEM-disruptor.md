##　disruptor队列
```
查看底层代码，log4j2之所以能在异步写日志时性能提高这么多，离不开优秀的mq组件disruptor。

目前使用该队列的知名软件包括但不限于Apache Storm、Camel、Log4j 2。

由于时间有限，本篇着重讲解底层队列的实现，因为这个对性能的影响是最大的。
同步性能最差，异步全局异步的性能接近异步appender的10倍，同样是异步实现的，为何性能有如此大的差距
往下我们分析一下BlockingQueue和disruptor的实现方式
ArrayBlockingQueue采用的是加锁的方式来处理线程安全问题的。

加锁的问题，虽然历代JDK一直投入大量的精力去解决问题，比如优化Sync关键字的实现方式、添加读写锁等，但是由于结构特性的问题，一直无法从根本上解决性能开销问题
disruptor的实现方式：
他们采用了环形数据结构来解决这个问题（他们称之为魔法圆环，或魔法圆圈之类的），此种数据结构的有点是，不需要记录额外的下标，直接由JNI返回可以操作的地址，然后当多线程并发读写的时候，使用的也是cas方式。
```